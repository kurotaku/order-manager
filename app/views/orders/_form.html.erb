<%= form_for(@order) do |f| %>

  <div class="form-group">
    <%= f.label :project_id, '顧客' %>
    <%= f.collection_select(:project_id, Project.all, :id, :name, { prompt: "未選択" }, { class: 'form-control' }) %>
  </div>
  
  <div class="form-group">
    <%= f.label :name, '発注名称' %>
    <%= f.text_field :name, class: 'form-control' %>
  </div>
  
  <div class="form-group">
    <%= f.label :document_date, '作成日' %>
    <%= f.text_field :document_date, class: 'form-control date-picker' %>
  </div>
  
  <div class="form-group">
    <%= f.label :staff, '担当' %>
    <%= f.collection_select(:staff, User.all, :name, :name, { prompt: "未選択" }, { class: 'form-control' }) %>
  </div>
  
  <div class="form-group">
    <%= f.label :partner_id, '発注先' %>
    <%= f.collection_select(:partner_id, Partner.all, :id, :name, { prompt: "未選択" }, { class: 'form-control' }) %>
  </div>
  
  <div class="form-group">
    <%= f.label :destination, '納入先' %>
    <%= f.select :destination, [['自社', 'true'], ['建築先', 'false']], {}, { class: 'form-control' } %>
  </div>
  
  <hr />
  
  <h2>部材登録</h2>
  
  <%= link_to_add_association '明細を追加', f, :line_items,
    class: 'btn btn-default',
    data: {
      association_insertion_node: '#detail-association-insertion-point',
      association_insertion_method: 'append' }
   %>
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">object id</th>
          <th scope="col">部材カテゴリー</th>
          <th scope="col">部材</th>
          <th scope="col">数量</th>
          <th scope="col">納期</th>
          <th scope="col">備考</th>
          <th scope="col">支払い金額</th>
        </tr>
      </thead>
      <tbody id="detail-association-insertion-point">
        <%= f.fields_for :line_items do |a| %>
        <%= render 'line_item_fields', f: a %>
        <% end %>
      </tbody>
      <script>
        $(document).on('change', '.category-switch', function(){
          var lineItemObjectId = $(this).attr('id');
          console.log(lineItemObjectId);
          var value = $(this).val();
          console.log(value);
          $.ajax({
            type: "GET",
            url: "<%= ajax_select_url%>",
            data: `value=${value}&line_item_object_id=${lineItemObjectId}`
          });
        });
      </script>
    </table>
  </div>

  <%= f.submit '登録する', class: 'btn btn-primary btn-block' %>
<% end %>